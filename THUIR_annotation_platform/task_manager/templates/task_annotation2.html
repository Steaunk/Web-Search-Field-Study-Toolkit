{% extends "base.html" %}
{% block title %} 任务标注 {% endblock %}
{% block content_title %} 任务标注 {% endblock %}
{% block content %}
    {% if not flag %}
    <script>
        alert('你有之前的浏览页面的结果有用性忘了标注,请检查!');
        window.location.href = '/task/query_annotation/{{ task.id }}';
    </script>
    {% endif %}
    <div class="row text-center">
        <h3>
            任务标注
        </h3>
    </div>
    <div class="row">
        <div class="col-xs-offset-1 col-xs-10">
            <div class="col-xs-12 list_header">
                该任务下查询词
            </div>
            {% for query, pages in queries_to_pages %}
                <div class="col-xs-12 list_row">
                    <label>{{ query.query_string }}</label>
                    <ul>
                        {% for page in pages %}
                            <li>第{{ page.page_id }}页<a href="/task/show_page/{{ page.id }}" target="_blank">(点击查看)</a></li>
                        {% endfor %}
                    </ul>
                </div>
            {% endfor %}
            <div class="col-xs-12"><br /></div>
            <div class="col-xs-12 list_header">
                任务标注
            </div>
            <form class="col-xs-12" id="task-form" action="" method="post" enctype='multipart/form-data'>
                {% csrf_token %}
                <label for="satisfaction_ratio" class="ratio col-xs-12 list_row">1. <b>任务满意度</b>：回顾此次搜索任务，你认为你对于完成该任务的整个搜索过程是否满意？0为非常不满意，4为非常满意</label>
                <div class="ratio col-xs-12 list_row">
                    <label><input type="radio" name="satisfaction_ratio"  value="0" /> 0分 </label>
                    <label><input type="radio" name="satisfaction_ratio"  value="1" /> 1分 </label>
                    <label><input type="radio" name="satisfaction_ratio"  value="2" /> 2分 </label>
                    <label><input type="radio" name="satisfaction_ratio"  value="3" /> 3分 </label>
                    <label><input type="radio" name="satisfaction_ratio"  value="4" /> 4分 </label>
                </div>
                <script>
                    $("input:radio[name='satisfaction_ratio'][value='{{ task.satisfaction }}']").attr('checked','true');
                </script>
{#                <div class="col-xs-12"><br /></div>#}
{#                <label for="ending_ratio" class="ratio col-xs-12 list_row"><b>2. 你认为搜索任务完成的怎么样？</b></label>#}
{#                <div class="ratio col-xs-12 list_row">#}
{#                    <label><input type="radio" name="ending_ratio"  value="4" /> 我得到了超过我预期的信息</label>#}
{#                        <br />#}
{#                    <label><input type="radio" name="ending_ratio"  value="3" /> 我得到了全部的预期信息</label>#}
{#                        <br />#}
{#                    <label><input type="radio" name="ending_ratio"  value="2" /> 我得到了部分信息</label>#}
{#                        <br />#}
{#                    <label><input type="radio" name="ending_ratio"  value="1" /> 没有得到我想要的信息</label>#}
{#                        <br />#}
{#                    <label><input type="radio" name="ending_ratio"  value="0" /> 其他 <input#}
{#                                    type="text" name="ending_text_{{ task.id }}" value="" placeholder="请在此处输入其他原因"#}
{#                                    size="50"/>{{ task.other_reason }}</label>#}
{#                </div>#}
{#                <script>#}
{#                    $("input:radio[name='ending_ratio'][value='{{ task_annotation.ending_type }}']").attr('checked','true');#}
{#                </script>#}
                <div class="col-xs-12"></div>
                <label for="information_difficulty" class="ratio col-xs-12 list_row">2. <b>任务困难度</b>：回顾此次搜索任务，你觉得找到完成该任务所需要的信息是否困难？0为非常简单，4为非常困难</label>
                <div class="ratio col-xs-12 list_row">
                    <label><input type="radio" name="information_difficulty"  value="0" /> 0分 </label>
                    <label><input type="radio" name="information_difficulty"  value="1" /> 1分 </label>
                    <label><input type="radio" name="information_difficulty"  value="2" /> 2分 </label>
                    <label><input type="radio" name="information_difficulty"  value="3" /> 3分 </label>
                    <label><input type="radio" name="information_difficulty"  value="4" /> 4分 </label>
                </div>
                <script>
                    $("input:radio[name='information_difficulty'][value='{{ task_annotation.information_difficulty }}']").attr('checked','true');
                </script>
{#                <div class="col-xs-12"><br /></div>#}
{#                <label for="query_ratio" class="ratio col-xs-12 list_row"><b>4. 你认为搜索该任务时组织清晰的查询词困难吗？请给出困难程度评分，0为非常简单，4为非常困难</b></label>#}
{#                <div class="ratio col-xs-12 list_row">#}
{#                    <label><input type="radio" name="query_ratio"  value="0" /> 0分 </label>#}
{#                    <label><input type="radio" name="query_ratio"  value="1" /> 1分 </label>#}
{#                    <label><input type="radio" name="query_ratio"  value="2" /> 2分 </label>#}
{#                    <label><input type="radio" name="query_ratio"  value="3" /> 3分 </label>#}
{#                    <label><input type="radio" name="query_ratio"  value="4" /> 4分 </label>#}
{#                </div>#}
{#                <script>#}
{#                    $("input:radio[name='query_ratio'][value='{{ task_annotation.query_difficulty }}']").attr('checked','true');#}
{#                </script>#}
                <div class="col-xs-12"></div>
                <label for="success" class="ratio col-xs-12 list_row">3. <b>任务成功度</b>：回顾此次搜索任务，你认为你在收集信息去完成该任务方面是否成功？0为非常失败，4为非常成功</label>
                <div class="ratio col-xs-12 list_row">
                    <label><input type="radio" name="success"  value="0" /> 0分 </label>
                    <label><input type="radio" name="success"  value="1" /> 1分 </label>
                    <label><input type="radio" name="success"  value="2" /> 2分 </label>
                    <label><input type="radio" name="success"  value="3" /> 3分 </label>
                    <label><input type="radio" name="success"  value="4" /> 4分 </label>
                </div>
                <script>
                    $("input:radio[name='success'][value='{{ task_annotation.success }}']").attr('checked','true');
                </script>
                <div class="col-xs-12"><br /></div>
            </form>
            <div class="col-xs-12">
                <div id="task-btn" class="col-xs-6 submit-btn btn btn-block btn-lg btn-primary">
                    提交标注
                </div>
            </div>
        </div>
    <script>
        $(function() {
            $('#task-btn').click(
                function () {
                    var satisfaction = $("[name='satisfaction_ratio']:checked");
                    var information_difficulty = $("[name='information_difficulty']:checked");
                    var success = $("[name='success']:checked");
                    if (satisfaction.val() == null) {
                        alert('请选择一个满意度!');
                        $("[name='satisfaction_ratio']").focus();
                        return
                    }
                    if (information_difficulty.val() == null) {
                        alert('请选择一个信息困难程度!');
                        $("[name='information_difficulty']").focus();
                        return
                    }
                    if (success.val() == null) {
                        alert('请选择一个搜索体验程度!');
                        $("[name='success']").focus();
                        return
                    }
                    if (confirm("确认提交任务标注?"))
                        $('#task-form').submit();
                }
            );
        });
    </script>
    </div>

{% endblock %}
